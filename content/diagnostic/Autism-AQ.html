<!--
LISTA DE VERIFICACIÃ“N

1. Mostrar 10 preguntas por pÃ¡gina.
2. Correjir el problema de que solo calcula las 10 preguntas por pÃ¡gina, en vez de las 50, por eso no paso de 10 el puntaje.
3. Actualmente puse las 50 preguntas en una pagina y calcula bien el resultado.

-->

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cuestionario AQ | SERA-24</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <!-- FontAwesome CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/fontawesome/4.7.0/css/font-awesome.min.css">
    <!-- Incluir Font Awesome desde CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">  
    <!-- FontAwesome CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.css">
    <!-- Estilos personalizados -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Patua+One&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Young+Serif&display=swap');

        body {
            background-color: #f7f9fc;
            font-family: 'Young Serif', serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Patua One';
            font-variant: small-caps;
            font-weight: bolder;
        }
        /* Contenedor principal */
        .custom-container {
            max-width: 900px;
            margin-top: 50px;
            margin-bottom: 50px;
        }
        /* Estilos de las preguntas */
        .question-card {
            margin-bottom: 20px;
        }
        .progress {
            height: 25px;
            margin-bottom: 30px;
        }
        .btn-group-toggle .btn {
            width: 100%;
        }
        /* Estilos de la barra de progreso */
        .progress-bar {
            background-color: #28a745;
        }
        /* Estilos para los emojis */
        .emoji {
            font-size: 1.2em;
        }
        /* Estilo para casillas de selecciÃ³n */
        .options-group label {
            width: 100%;
        }
    </style>
</head>
<body>

    <!-- Encabezado -->
    <header class="bg-primary text-white text-center py-4">
        <h1>ğŸ§© Cuestionario AQ</h1>
        <p>Â¡EvalÃºa tus rasgos del espectro autista!</p>
    </header>

    <!-- Contenido principal -->
    <div class="container custom-container">
        <!-- Barra de progreso -->
        <div class="progress">
            <div id="progress-bar" class="progress-bar progress-bar-striped" role="progressbar" style="width: 0%;">0%</div>
        </div>

        <!-- Formulario -->
        <form id="quiz-form">
            <div class="row" id="question-container">
                <!-- Las preguntas se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
            </div>
            <div class="d-flex justify-content-between">
                <button type="button" id="prev-btn" class="btn btn-secondary" disabled>Anterior</button>
                <button type="button" id="next-btn" class="btn btn-secondary">Siguiente</button>
                <button type="submit" id="submit-btn" class="btn btn-primary" style="display: none;">Finalizar</button>
            </div>
        </form>
    </div>

    <!-- Iconos flotantes -->
    <!-- Ãcono de WhatsApp flotante -->
    <a href="https://wa.me/573229608830" class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 footer-section">
        <div class="container">
            <p><i class="fas fa-solid fa-code"></i> con â¤ï¸ por JesÃºs David Silva Rangel.<br> &copy; 2024 - Todos los derechos reservados.</p>
            <div>
                <a href="https://github.com/Jesus-David-Silva-Rangel-19" class="text-white mr-3" target="_blank"><i class="fab fa-github fa-2x"></i></a>
                <a href="https://www.linkedin.com/in/jes%C3%BAs-david-silva-rangel-77706a260/" class="text-white mr-3" target="_blank"><i class="fab fa-linkedin fa-2x"></i></a>
                <a href="mailto:jdsr.cuentapersonal@gmail.com" class="text-white mr-3"><i class="fas fa-envelope fa-2x"></i></a>
                <a href="tel:+573229608830" class="text-white"><i class="fas fa-phone fa-2x"></i></a>
            </div>
        </div>
    </footer>

    <!-- Scripts necesarios -->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Popper.js (necesario para Bootstrap 4) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <!-- Script personalizado -->
    <script>
       const questions = [
            { text: "Me resulta fÃ¡cil entablar una conversaciÃ³n con los demÃ¡s. ğŸ˜Š", positive: false },
            { text: "Me parece mÃ¡s fÃ¡cil hacer las cosas siempre de la misma manera. ğŸ”„", positive: true },
            { text: "Si intento imaginar algo, me resulta muy fÃ¡cil crearlo en mi mente. ğŸ’­", positive: false },
            { text: "A menudo me siento tan fascinado por algo que pierdo de vista otras cosas. ğŸ¤”", positive: true },
            { text: "A menudo noto pequeÃ±os sonidos que otros no perciben. ğŸ§", positive: true },
            { text: "Por lo general, entiendo lo que siente otra persona al mirarla a los ojos. ğŸ‘€", positive: false },
            { text: "Me resulta fÃ¡cil reconocer si alguien no estÃ¡ prestando atenciÃ³n en una conversaciÃ³n. ğŸ—£ï¸", positive: false },
            { text: "Cuando leo algo, me interesa mÃ¡s intentar entender el significado que fijarme en los detalles. ğŸ“–", positive: false },
            { text: "Me resulta fÃ¡cil hacer mÃ¡s de una cosa a la vez. ğŸ¯", positive: false },
            { text: "Soy fascinado/a por los nÃºmeros o patrones de datos. ğŸ”¢", positive: true },
            { text: "Normalmente no noto pequeÃ±os cambios en una situaciÃ³n o en la apariencia de una persona. ğŸ‘“", positive: true },
            { text: "SÃ© cÃ³mo mantener una conversaciÃ³n interesante con otras personas. ğŸ’¬", positive: false },
            { text: "Me resulta fÃ¡cil \"leer entre lÃ­neas\" cuando alguien dice algo. ğŸ“š", positive: false },
            { text: "En las reuniones sociales, me resulta fÃ¡cil seguir las conversaciones con varias personas. ğŸ‘«", positive: false },
            { text: "Me resulta difÃ­cil hacer frente a cambios en mis planes. ğŸ“…", positive: true },
            { text: "Normalmente me concentro en todo lo que hago hasta que lo termino. âœ…", positive: true },
            { text: "Me resulta difÃ­cil entender las perspectivas de los demÃ¡s. ğŸ‘¥", positive: true },
            { text: "Puedo hacer amigos con bastante facilidad. ğŸ¤—", positive: false },
            { text: "Me siento fascinado/a con las fechas. ğŸ—“ï¸", positive: true },
            { text: "Encuentro divertido crear historias o imaginar situaciones. âœï¸", positive: false },
            { text: "Me resulta difÃ­cil resolver problemas de grupo cuando las emociones de los demÃ¡s son importantes. ğŸ¤", positive: true },
            { text: "A menudo noto detalles que otros pasan por alto. ğŸ”", positive: true },
            { text: "Me resulta difÃ­cil interpretar las intenciones de los demÃ¡s. ğŸ¤¨", positive: true },
            { text: "Me interesa coleccionar cosas. ğŸ§¸", positive: true },
            { text: "Prefiero hacer las cosas solo/a antes que con otras personas. ğŸš¶", positive: true },
            { text: "Me resulta mÃ¡s fÃ¡cil encontrar un patrÃ³n que entender la conversaciÃ³n. ğŸ“Š", positive: true },
            { text: "Me cuesta saber cÃ³mo actuar en situaciones sociales desconocidas. ğŸ˜“", positive: true },
            { text: "Me resulta fÃ¡cil explicar por quÃ© me siento de cierta manera. ğŸ˜Š", positive: false },
            { text: "Encuentro Ãºtil planificar las actividades con antelaciÃ³n. ğŸ“", positive: true },
            { text: "Si alguien me interrumpe mientras estoy haciendo algo, me resulta fÃ¡cil volver a concentrarme. ğŸ§˜", positive: false },
            { text: "Prefiero hacer cosas de forma estructurada antes que improvisada. ğŸ—‚ï¸", positive: true },
            { text: "A menudo me resulta fÃ¡cil imaginar cÃ³mo serÃ­an diferentes situaciones en la vida. ğŸŒˆ", positive: false },
            { text: "Disfruto en reuniones sociales, incluso si no conozco a muchas personas. ğŸ‰", positive: false },
            { text: "Me resulta difÃ­cil captar los dobles sentidos en las conversaciones. ğŸ¤”", positive: true },
            { text: "Prefiero escuchar mÃºsica o ver televisiÃ³n en vez de salir a socializar. ğŸ§", positive: true },
            { text: "Me fijo mucho en los pequeÃ±os detalles. ğŸ”", positive: true },
            { text: "Puedo entender los sentimientos de los demÃ¡s al mirar su rostro. ğŸ˜Š", positive: false },
            { text: "Prefiero tareas que sigan un procedimiento establecido. ğŸ“‹", positive: true },
            { text: "Puedo disfrutar mucho de eventos sociales, incluso en situaciones desconocidas. ğŸŠ", positive: false },
            { text: "Me cuesta cambiar de un tema a otro en una conversaciÃ³n. ğŸ”„", positive: true },
            { text: "Me interesan los patrones y las estructuras matemÃ¡ticas. â—", positive: true },
            { text: "Puedo adaptarme fÃ¡cilmente a los cambios inesperados en mis planes. ğŸ”„", positive: false },
            { text: "Me fascinan los sistemas mecÃ¡nicos o tecnolÃ³gicos. âš™ï¸", positive: true },
            { text: "Prefiero hablar sobre hechos y datos en lugar de emociones o relaciones personales. ğŸ’¾", positive: true },
            { text: "Me resulta difÃ­cil saber si estoy molestando a alguien sin que me lo digan directamente. ğŸ˜•", positive: true },
            { text: "Disfruto participando en juegos imaginativos o creativos. ğŸ¨", positive: false },
            { text: "Me interesa saber las razones detrÃ¡s de las normas sociales y culturales. ğŸŒ", positive: true },
            { text: "A menudo me preocupo mÃ¡s por los hechos objetivos que por las emociones. ğŸ“Š", positive: true },
            { text: "Prefiero estar en lugares tranquilos en lugar de ruidosos o concurridos. ğŸï¸", positive: true },
            { text: "Me cuesta reconocer cuando alguien estÃ¡ siendo sarcÃ¡stico. ğŸ¤¨", positive: true }
        ];

        let currentStep = 0;
const questionsPerPage = 50;
const totalSteps = Math.ceil(questions.length / questionsPerPage);

// Objeto global para almacenar respuestas del usuario
let userResponses = {};

const quizForm = document.getElementById('quiz-form');
const questionContainer = document.getElementById('question-container');
const progressBar = document.getElementById('progress-bar');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const submitBtn = document.getElementById('submit-btn');

function showStep(step) {
    // Actualizar la barra de progreso
    const progress = ((step) / (totalSteps - 1)) * 100;
    progressBar.style.width = progress + '%';
    progressBar.innerText = `${Math.round(progress)}%`;

    // Mostrar u ocultar botones
    prevBtn.disabled = step === 0;
    nextBtn.style.display = step === totalSteps - 1 ? 'none' : 'inline-block';
    submitBtn.style.display = step === totalSteps - 1 ? 'inline-block' : 'none';

    // Mostrar las preguntas del paso actual
    questionContainer.innerHTML = '';
    const start = step * questionsPerPage;
    const end = start + questionsPerPage;
    for (let i = start; i < end && i < questions.length; i++) {
        const q = questions[i];
        const questionDiv = document.createElement('div');
        questionDiv.classList.add('col-md-6');
        questionDiv.innerHTML = `
            <div class="card question-card">
                <div class="card-body">
                    <p><strong>${i + 1}. ${q.text}</strong></p>
                    <div class="options-group">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="question${i}" id="agree${i}" value="agree" required ${userResponses[`question${i}`] === 'agree' ? 'checked' : ''}>
                            <label class="form-check-label" for="agree${i}">De acuerdo</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="question${i}" id="disagree${i}" value="disagree" ${userResponses[`question${i}`] === 'disagree' ? 'checked' : ''}>
                            <label class="form-check-label" for="disagree${i}">En desacuerdo</label>
                        </div>
                    </div>
                </div>
            </div>
        `;
        questionContainer.appendChild(questionDiv);
    }
}

function saveCurrentPageResponses() {
    // Guardar las respuestas de la pÃ¡gina actual
    const formData = new FormData(quizForm);
    for (let i = currentStep * questionsPerPage; i < (currentStep + 1) * questionsPerPage && i < questions.length; i++) {
        const response = formData.get(`question${i}`);
        if (response) {
            userResponses[`question${i}`] = response;
        }
    }
}

nextBtn.addEventListener('click', () => {
    if (validateStep()) {
        saveCurrentPageResponses();
        currentStep++;
        showStep(currentStep);
    } else {
        Swal.fire({
            icon: 'warning',
            title: 'Â¡AtenciÃ³n!',
            text: 'Por favor, responde todas las preguntas.',
            confirmButtonText: 'Aceptar'
        });
    }
});

prevBtn.addEventListener('click', () => {
    saveCurrentPageResponses();
    currentStep--;
    showStep(currentStep);
});

quizForm.addEventListener('submit', (e) => {
    e.preventDefault();
    if (validateStep()) {
        // Guardar respuestas de la Ãºltima pÃ¡gina
        saveCurrentPageResponses();

        // Calcular el puntaje total
        let totalScore = 0;
        for (let i = 0; i < questions.length; i++) {
            const q = questions[i];
            const response = userResponses[`question${i}`];
            if (response) {
                if ((q.positive && response === 'agree') || (!q.positive && response === 'disagree')) {
                    totalScore += 1;
                }
            }
        }

        // InterpretaciÃ³n del puntaje
        let resultText = '';
        if (totalScore <= 25) {
            resultText = 'Resultados indican un perfil neurotÃ­pico.';
        } else if (totalScore <= 31) {
            resultText = 'Resultados sugieren rasgos intermedios asociados al espectro autista.';
        } else {
            resultText = 'Resultados indican una alta probabilidad de estar dentro del espectro autista. Se recomienda una consulta profesional para un diagnÃ³stico mÃ¡s preciso.';
        }

        Swal.fire({
            title: 'Resultado del Cuestionario',
            html: `<p>Tu puntuaciÃ³n es: <strong>${totalScore}</strong></p><p>${resultText}</p>`,
            icon: 'info',
            confirmButtonText: 'Aceptar'
        });
    } else {
        Swal.fire({
            icon: 'warning',
            title: 'Â¡AtenciÃ³n!',
            text: 'Por favor, responde todas las preguntas.',
            confirmButtonText: 'Aceptar'
        });
    }
});

function validateStep() {
    const inputs = document.querySelectorAll(`#question-container input[type="radio"]:checked`);
    const selectedCount = inputs.length;
    const totalQuestionsInStep = Math.min(questionsPerPage, questions.length - (currentStep * questionsPerPage));
    return selectedCount === totalQuestionsInStep;
}

showStep(currentStep);



    // Agregar las respuestas para un paciente con autismo
    const patientAnswers = [
        'disagree', 'agree', 'disagree', 'agree', 'agree',
        'disagree', 'disagree', 'disagree', 'disagree', 'agree',
        'agree', 'disagree', 'disagree', 'disagree', 'agree',
        'agree', 'disagree', 'agree', 'disagree', 'disagree',
        'agree', 'agree', 'agree', 'agree', 'agree',
        'agree', 'disagree', 'agree', 'disagree', 'disagree',
        'agree', 'disagree', 'disagree', 'agree', 'agree',
        'disagree', 'agree', 'disagree', 'disagree', 'agree',
        'agree', 'disagree', 'agree', 'disagree', 'disagree', 'agree', 'disagree', 'disagree', 'agree', 'agree'
    ];

    // Simular las respuestas del paciente
    for (let i = 0; i < questions.length; i++) {
        const response = patientAnswers[i];
        const input = document.getElementById(response + i);
        if (input) {
            input.checked = true;
        }
    }

    // Mostrar el resultado automÃ¡ticamente
    quizForm.dispatchEvent(new Event('submit'));

    // Boton para mostrar las respuestas
    const showAnswersBtn = document.createElement('button');
    </script>
    
</body>
</html>